# W-02 — 세션 키를 채널 중심으로 둘지 tenant/user까지 확장할지

## 문맥
- soma-work는 현재 channel+thread 기반 세션 공유 모델이다. v3에서 키 정책을 고정하지 않으면 인터럽트, 저장, 권한 로직이 계속 흔들린다.

## 선택지별 트레이드오프
### A) `channel:thread`
- 트레이드오프: 구현은 단순하지만 멀티유저/멀티워크스페이스 충돌 위험이 크다.
- 되돌리기 비용(코드 변경량): 500줄 미만

### B) `tenant:channel:thread`
- 트레이드오프: 워크스페이스 충돌을 줄이면서 공유 스레드 모델을 유지할 수 있다.
- 되돌리기 비용(코드 변경량): 300줄 미만

### C) `tenant:channel:thread:user`
- 트레이드오프: 격리는 강하지만 같은 스레드 협업 경험을 별도 조정해야 한다.
- 되돌리기 비용(코드 변경량): 300줄 미만

## 질문 중요도
- 최대 되돌리기 비용: 500줄 미만
- 중요도: 매우 높음 (되돌릴 때 바뀌는 코드 경로의 폭 기준)

## 결정 체크포인트
- 선택 즉시 영향받는 영역: 식별자 스키마, 세션 키, 권한/저장소 partition, 채널 어댑터 계약
- 결정 후 확인할 지표: 세션 충돌 건수, 권한 오판률, adapter 변경량, cross-repo 드리프트 건수
