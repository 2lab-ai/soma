# W-07 — 세션/설정 저장소 partition 키를 어디까지 확장할지

## 문맥
- 키 전략은 세션 충돌과 데이터 누수의 근본 원인이다. 한 번 굳으면 되돌리기 비용이 크다.

## 선택지별 트레이드오프
### A) channel/thread 유지
- 트레이드오프: 빠르지만 다중 tenant 환경에서 충돌 가능성이 남는다.
- 되돌리기 비용(코드 변경량): 그 이상

### B) tenant/channel/thread
- 트레이드오프: 충돌 위험을 낮추면서 공유 세션 모델을 유지한다.
- 되돌리기 비용(코드 변경량): 300줄 미만

### C) tenant/channel/thread/user
- 트레이드오프: 격리성은 최고지만 공유 문맥 사용성은 추가 설계가 필요하다.
- 되돌리기 비용(코드 변경량): 300줄 미만

## 질문 중요도
- 최대 되돌리기 비용: 그 이상
- 중요도: 최상 (되돌릴 때 바뀌는 코드 경로의 폭 기준)

## 결정 체크포인트
- 선택 즉시 영향받는 영역: 식별자 스키마, 세션 키, 권한/저장소 partition, 채널 어댑터 계약
- 결정 후 확인할 지표: 세션 충돌 건수, 권한 오판률, adapter 변경량, cross-repo 드리프트 건수
